function e(e,t,i){const r=document.createElement(e);for(const e in t)r.setAttribute(e,t[e]);for(const e in i)r.style.setProperty(e,i[e]);return r}function t(t,i="gradient-picker"){const r=e("div",{class:i});return t.append(r),r}function i(t,i,r="gradient-picker__select"){const n=e("select",{class:r});return i.forEach((e=>{const t=document.createElement("option");t.value=e,t.text=e,n.append(t)})),t.append(n),n}class r{constructor({el:e}){this.direction="right",this.type="linear",this.stops=[],this.isDragging=!1,this.el=e,this.containerPicker=t(this.el,"gradient-picker"),this.optionsEl=t(this.containerPicker,"gradient-picker__options"),this.previewEl=t(this.containerPicker,"gradient-picker__preview"),this.colorHandlersEl=t(this.containerPicker,"gradient-picker__colors"),this.typeInput=i(this.optionsEl,["linear","radial"],"gradient-picker__select"),this.directionInput=i(this.optionsEl,["top","left","center","bottom","right"],"gradient-picker__select"),this.addColorStop("#af68fe",9.3),this.addColorStop("#65dfff",75.1),this.listener()}addColorStop(e,t){this.stops.push({color:e,position:t}),this.createStopHandler(this.stops.length-1),this.updateElementBackground()}changeGradientType(e){this.type=e,this.updateElementBackground()}getGradientString(e=this.type,t=this.direction){const i=[...this.stops].sort(((e,t)=>e.position-t.position)).map((e=>{return`${e.color} ${t=e.position,Math.round(100*t)/100}%`;var t})).join(",");if("radial"===e){return`radial-gradient(circle ${{bottom:"at center bottom",center:"",left:"at left center",right:"at center right",top:"at center top"}[t]}, ${i})`}return`linear-gradient(to ${t},${i})`}updateElementBackground(){this.previewEl.style.backgroundImage=this.getGradientString("linear","right")}createStopHandler(t){const i=this.stops[t],r=Math.ceil(i.position),n=e("div",{class:"gradient-picker__preview-handler","data-index":t.toString()},{"--handler-position":`${i.position}%`,"--handler-color":i.color}),o=e("div",{class:"gradient-picker__colors-variation","data-index":t.toString()},{"--color-order":r.toString()}),s=e("div",{class:"gradient-picker__colors-remover"}),a=e("div",{class:"gradient-picker__colors-picker"}),c=e("input",{type:"color",class:"gradient-picker__colors-picker-input","data-index-color":t.toString(),value:i.color},{"--color-value":i.color}),l=e("input",{type:"text",class:"gradient-picker__colors-picker-input","data-index-color":t.toString(),value:i.color},{"--color-value":i.color});a.append(c),a.append(l),c.addEventListener("input",(e=>this.onColorChange(e,t))),l.addEventListener("input",(e=>this.onColorChange(e,t))),n.addEventListener("mousedown",(e=>this.onHandlerMouseDown(e))),n.addEventListener("mouseup",(e=>this.onHandlerMouseUp(e))),this.previewEl.addEventListener("mousemove",(e=>this.onHandlerMouseMove(e))),s.addEventListener("click",(()=>{this.stops.splice(t,1),n.remove(),o.remove(),this.updateElementBackground()})),o.append(a,s),this.previewEl.append(n),this.colorHandlersEl.append(o)}onHandlerMouseDown(e){e.target.classList.add("active"),this.isDragging=!0}onHandlerMouseMove(e){if(!this.isDragging)return;let t=document.querySelector(".gradient-picker__preview-handler.active");if(!t?.classList.contains("active"))return;const i=~~(t.getAttribute("data-index")||0),r=this.getPercentage(e.clientX);r<.5||r>99.5||(this.changePosition(i,r),this.updateElementBackground())}onHandlerMouseUp(e){e.target.classList.remove("active"),this.isDragging=!1}changeColor(e,t){this.stops[e].color=t,this.colorHandlersEl.querySelectorAll(`input[data-index-color='${e}']`).forEach((e=>e.value=t)),this.previewEl.querySelectorAll(`div.gradient-picker__preview-handler[data-index='${e}']`).forEach((e=>e.style.setProperty("--handler-color",t)))}changePosition(e,t){this.stops[e].position=t;const i=Math.ceil(t);this.previewEl.querySelectorAll(`div.gradient-picker__preview-handler[data-index='${e}']`).forEach((e=>e.style.setProperty("--handler-position",t+"%"))),this.colorHandlersEl.querySelectorAll(`div.gradient-picker__colors-variation[data-index='${e}']`).forEach((e=>e.style.setProperty("--color-order",i.toString())))}onColorChange(e,t){this.changeColor(t,e.target.value),this.updateElementBackground()}getPercentage(e){return(e-this.previewEl.getBoundingClientRect().x)/~~getComputedStyle(this.previewEl).width.slice(0,-2)*100}listener(){this.previewEl.addEventListener("click",(e=>{if(e.target.classList.contains("gradient-picker__preview-handler")||this.isDragging)return;if(!this.previewEl.contains(e.target))return;const t=this.getPercentage(e.clientX);this.addColorStop("#333333",t)})),this.directionInput?.addEventListener("input",(()=>{this.direction=this.directionInput?.value,this.updateElementBackground()})),this.typeInput?.addEventListener("input",(()=>{this.type=this.typeInput?.value,this.updateElementBackground()}))}}export{r as GradientPicker};
//# sourceMappingURL=gradient-picker.js.map
